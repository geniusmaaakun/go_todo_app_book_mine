DB操作とhandlerの操作を責務分けすることでテストしやすくする

ハンドラの中でDB操作などのロジックも組み込まれている為テストしにくい
疎結合にしてテストしやすくする

3つのパッケージに分ける。それぞれの責務を小さくする
handler: HTTPリクエストとレスポンスの処理を行うパッケージ
store: 永続化操作を行う
service: 永続化操作とアプリケーションロジック、ビジネスロジックの実装を組み合わせて期待される挙動を実装する

またインターフェースを挟むことで、他のパッケージの実装内容に影響しないテストコードを書ける

httpハンドラーの実装を分解する
handler/service.go
ビジネスロジックと永続化に関わる処理を取り除く
インターフェースを定義することで、パッケージの参照を防ぐ。モック処理に入れ替えることができる


go generateを用いたモックの自動生成
mockパッケージを使う
go generateでモックファイルが作成される




ユーザー登録機能の追加